#  **HMS** **医院门诊预约系统**

 

**[** **部署文档]**

 

| 成员 | 杨宏飞 |
| ---- | ------ |
| 成员 | 赵子璁 |
| 成员 | 陶佑鹏 |
| 成员 | 孙宇航 |
| 成员 | 张昊然 |

 

 

 

 

 

 

 

 





# 1. 部署说明

本组为“HMS医院门诊预约系统”租赁了一个云服务器与一个数据库，故采用云端部署的形式运行项目。

# 2. 部署环境要求

## 2.1后端服务器

(1) 操作系统： CentOS 7.9 64位

(2) CPU &内存：1核(vCPU) 2 GiB

(3) 处理器型号：AMD或Intel 1.6GHz以上

(4) 带宽：1Mbps

(5) 内存要求：256MB及以上

(6) java版本：jdk-17_linux-x64

(7) springboot版本：3.0.5及以上

## 2.2 前端服务器

(1) 操作系统：CentOS 7.9 64位

(2) CPU&内存：1核(vCPU) 2 GiB

(3) 处理器型号：AMD或Intel 1.6GHz以上

(4) 带宽：1Mbps

(5) 内存要求：256MB及以上

(6) Nginx版本：1.18.0及以上

(7) Nodejs版本：10.19.0及以上

(8) npm版本：6.14.4及以上



 

## 2.3 数据库

(1) 数据库版本：MySQL 8.0以上

(2) CPU：1核

(3) 数据库内存：1GB

(4) 最大连接数：2000

(5) 最大IOPS：10000

# 3. 后端部署步骤

## 3.1 连接云服务器

在阿里云云服务器管理控制台连接阿里云服务器。打开页面后，点击远程连接选择通过Workbench远程连接，按要求输入用户名和密码后点击连接。连接成功后会自动跳转至如图1所示界面：

![image-20230527104024776](img/image-20230527104024776.png)

<center>图 1 连接成功界面

 

## 3.2 下载项目与准备运行环境

首先将后端springboot项目打包, 成功输出如图2.

![image-20230527105924184](img/image-20230527105924184.png)

<center>图 2 打包成功输出结果

然后准备运行环境，使用终端下载jdk。

操作流程如下：

```shell
# 用wget命令在 /opt 目录下下载 *.tar.gz压缩包
cd /opt
wget https://download.oracle.com/java/17/latest/jdk-17_linux-x64_bin.tar.gz

# 解压tar.gz压缩包：
tar -zxvf jdk-17_linux-x64_bin.tar.gz 
# 将jdk-17.0.1改名为java17
mv jdk-17.0.1 java17
# 删除没用的压缩包
rm -rf jdk-17_linux-x64_bin.tar.gz 

# 配置环境变量
# 进入profile文件，按i进入编辑模式
vim /etc/profile
# 在文件最下方添加
export JAVA_HOME=/opt/java17
export PATH=$PATH:$JAVA_HOME/bin;
export CLASSPATH=.:$JAVA_HOME/lib/dt.jar:$JAVA_HOME/lib/tools.jar;
```



![image-20230527105635030](img/image-20230527105635030.png)

<center>图 3 安装成功

下载完毕后，在终端界面点击文件->打开新文件树，在任意位置创建目录作为项目的根目录，将打包好的springboot项目上传至根目录。

![image-20230527110453623](img/image-20230527110453623.png)

<center>图 4 上传成功

这时服务器端的配置基本已经完成。本项目还需要连接一个远程MySQL数据库，数据库的配置文件已经写入到了application.yml文件中，不需要手动修改。

至此项目的后端服务器配置已经完成。

## 3.3 启动项目

在项目目录中，输入图5中命令，看到输出提示后，就说明项目启动成功。

![image-20230527110520639](img/image-20230527110520639.png)

<center>图5 启动成功页面

至此，后端已经成功部署到服务器。



# 4. 前端部署步骤

## 4.1 连接云服务器

使用任意一个具有SSH客户端的终端连接服务器的root账号，这里使用Win11的PowerShell对服务器进行连接，输入连接命令即可，输入命令时要将root@后的IP地址修改为想要部署前端服务器的地址。

![img](D:\Typora\img\clip_image016.png)

**图****8** **连接成功界面**

需要注意的是，这里使用的是公私钥验证的方式连接服务器，如果没有设置服务器的公私钥验证，则输入完上述命令后，还需要输入服务器的密码才能成功连接服务器。具体的服务器的密码设置方式，请参见对应服务器运营商的文档。

## 4.2 安装项目依赖

在云服务器上安装项目依赖，需要安装Node.js、npm和Nginx三个依赖，输入如图9所示的命令即可安装这些依赖。

![img](D:\Typora\img\clip_image018.png)

**图****9** **前端依赖安装**

若服务器没有安装这些依赖，则输入命令后系统可能会询问“是否确认安装该软件？[Y/N]”，此时输入Y并回车即可。

## 4.3 下载项目

将云服务器切换到想要放置项目文件的目录下，这里选择root用户的家目录，输入项目克隆命令如图10所示。

由于项目暂时没有开源，故这里需要输入具有clone权限的访问者账号和密码，另外Ubuntu 20.04自带git仓库管理软甲，如果出现“没有git命令”的情况，则需要使用“sudo apt install git”命令先安装git再克隆仓库。

![img](D:\Typora\img\clip_image020.png)

**图****10** **下载项目**

## 4.4 在服务器上构建项目

切换到克隆的仓库的路径下，使用如tu11所示的命令安装构建项目所需要的包：

![img](D:\Typora\img\clip_image022.png)

**图****11** **安装所需包**



 

等待安装完成后，使用图12所示的命令构建项目，当项目构建完成后，构建好的文件存放在项目目录的dist文件夹下：

![img](D:\Typora\img\clip_image024.png)

**图****12** **构建成功**

接下来，选择将该dist目录移动到/var/www目录下。

![img](D:\Typora\img\clip_image026.png)

**图****13** **移动项目**

需要注意的是，如果该目录下已经存在dist文件夹，则需要先删除该文件夹或者将构建好的dist文件夹重命名再做移动。

## 4.5 配置NGINX

使用图14所示的命令找到Nginx配置文件的路径：

![img](D:\Typora\img\clip_image028.png)

**图****14** **寻找****Nginx****路径**



 

接下来，打开该路径下的Nginx配置文件，这里使用VSCode打开该配置文件。若没有在服务器上配置VSCode，则还可以通过Ubuntu自带的Vim编辑器打开该配置文件。图15所示的是VSCode打开的情况。

![img](D:\Typora\img\clip_image030.png)

**图****15** **配置文件信息**

找到该文件如图16所示的“虚拟主机配置”（即Virtual Host Configs）字段：

![img](D:\Typora\img\clip_image032.png)

**图****16** **虚拟主机配置**

接下来，将该字段修改为图17中内容。或者在该字段包含的任意目录下添加一个文本文件，文本文件的内容为图17中内容。这里选择在sites-enabled目录下添加新文件的方式来进行配置：

![img](D:\Typora\img\clip_image034.png)

**图****17** **修改字段**

需要注意的是，这里指定了服务器的监听端口为80，若服务器没有开放80端口的访问，则不能访问前端网页。另外，若root指定的dist文件夹即为前文中项目构建的dist文件夹中存放的位置。最后，使用“nginx -s reload”命令更新Nginx的配置即可。

至此，前端的部署已经完成，可以通过浏览器访问服务器来测试部署是否成功。